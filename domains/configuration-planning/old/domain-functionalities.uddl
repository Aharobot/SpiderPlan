;; Domain to showcase configuration planning

(:initial-context
	(:goals
		(?Goal (displayed terminal1 (picture-of door processed)))
	)
	(:temporal
		(at ?Goal [100 120] [200 200])
	)
)

(functionality 
	(get-image-stream-of ?Robot ?Object)
	(:constraints
		(:goals
			(?Pre (has-view-on ?Robot ?Object))
		)
		(:temporal
			(during ?THIS ?Pre)
			(equals ?THIS ?OutStream)
		)
		(:domain
			(new-object ?ID picture-ids)
		)
		(configuration
			(output 
				(?OutStream (image (picture-of ?Object raw)))
			)
		)
	)
)

(functionality
	(process-image-stream ?Machine)
	(:constraints
		(:goals
			(?Pre running ?Machine)
		)
		(:temporal
			(during ?THIS ?Pre)
			(equals ?THIS ?OutStream)
			(overlaps ?InStream ?OutStream [1 10])
		)
		(:prolog
			(hasGPU ?Machine)
		)
		(configuration
			(input
				(?InStream (image (picture-of ?Object raw)))
			)
			(output 
				(?OutStream (image (picture-of ?Object processed)))
			)
		)
	)
)

(:operator 
	(display ?Image ?Machine)
	(:preconditions
		(?Pre running ?Machine)
	)
	(:effects
		(?Eff (displayed ?Machine ?Image))
	)
	(:constraints
		(:goals
			(?Pre running ?Machine)
		)
		(:temporal
			(during ?THIS ?Pre [1 inf] [1 inf])
			(equals ?THIS ?Eff)
		)
		(:prolog
			(hasDisplay ?Machine)
		)
		(configuration
			(input
				(?InStream (image ?Image))
			)		
		)
	)
)